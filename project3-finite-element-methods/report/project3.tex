\documentclass[11pt]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[letterpaper]{geometry}

\usepackage{graphicx}
\usepackage{mathpazo}

\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{bm}
\usepackage{siunitx}
\usepackage{cancel}
\usepackage{float}
\usepackage{empheq}
\usepackage[most]{tcolorbox}
% \usepackage{breqn}

% Sexy yellow highlighted boxed equations!
\newtcbox{\mymath}[1][]{%
  nobeforeafter, math upper, tcbox raise base,
  enhanced, colframe=black!30!black,
  colback=yellow!30, boxrule=1pt,
  #1}

% Hyperlinks with decent looking default colors.
\usepackage{hyperref}
\usepackage{xcolor}
\hypersetup{
  colorlinks,
  linkcolor={red!50!black},
  citecolor={blue!50!black},
  urlcolor={blue!80!black}
}

% For those sexy spaced low small caps from classic-thesis!
\usepackage{microtype}
\usepackage{textcase}
\DeclareRobustCommand{\spacedlowsmallcaps}[1]{%
  \textls[80]{\scshape\MakeTextLowercase{#1}}%
}

% Replaced mathpazo \sum symbol with computer modern's.
\DeclareSymbolFont{cmlargesymbols}{OMX}{cmex}{m}{n}
\let\sumop\relax
\DeclareMathSymbol{\sumop}{\mathop}{cmlargesymbols}{"50}

% Force indent command.
\newcommand{\forceindent}{\leavevmode{\parindent=1em\indent}}

% Math shortcuts.
\newcommand\p[2]{\frac{\partial #1}{\partial #2}}
\newcommand\G[6]{\p{g_{#1 #2}}{#5}\p{g_{#3 #4}}{#6}}

% fancyhdr header and footer.
\usepackage{fancyhdr}
\pagestyle{fancy} 
\fancyhead{}
\rhead{Ali Ramadhan}
\lhead{6.339 Project 3---Finite Element Methods}
\cfoot{\thepage}

\title{\spacedlowsmallcaps{6.339: Numerical Methods for Partial Differential Equations}\\ \spacedlowsmallcaps{Project three: Finite Element Methods}}
\author{Ali Ramadhan$^\text{†}$ (\href{mailto:alir@mit.edu}{\texttt{alir@mit.edu}})}
\date{\textit{$^\text{†}$Department of Earth, Atmospheric, and Planetary Sciences}}

\renewcommand\thesubsection{\thesection(\alph{subsection})}

\begin{document}
\maketitle

In this project, we will utilize finite element methods to study the deflection or bending of beams by solving the linear elasticity equation. It assumes that the strains and deformations are small, thus yielding a linear relationship between the stress and strain components.\footnotemark~In its most general form, it can be expressed as a balance of linear momentum using Newton's second law
\begin{equation*} \label{eq:linElasGen}
  \bm{\nabla\cdot\sigma + f} = \rho\ddot{\bm{u}}
\end{equation*}
where $\bm{\sigma}$ is the \emph{Cauchy-stress tensor}, $\bm{f}$ is the body force per unit volume, $\rho$ is the mass density, and $\ddot{\bm{u}}$ is the second time derivative of the deformation vector $\bm{u}$. The Cauchy-stress tensor is a second-order or rank-2 tensor. Its diagonal components $\sigma_{kk}$ represent the normal stresses while the off-diagonal components $\sigma_{ij} \; (i \ne j)$  represent the shear stresses at a point. The $\sigma_{ij}$ component corresponds to the stress acting on a plane normal to the $x_i$-axis in the direction of the $x_j$-axis.

\footnotetext{The more general theory of nonlinear elasticity, or finite strain theory, can be used to model arbitrarily large strains and rotations as well as nonlinear stress-strain relations involving effects such as buckling, yielding, and plasticity.}

In two dimensions the linear elasticity equation can be expanded and written as
\begin{equation} \label{eq:linElas}
  \p{\bm{\sigma}_x(\bm{u})}{x} + \p{\bm{\sigma}_y(\bm{u})}{y} + \bm{f} = 0
\end{equation}
where $\bm{u} = (u_x, u_y)$, $\bm{\sigma}_x = (\sigma_{xx}, \sigma_{xy})$ and $\bm{\sigma}_y = (\sigma_{yx}, \sigma_{yy})$ are the stress vector fields, and $\bm{f} = (f_x, f_y)$, all of which are multivariate functions of $x$ and $y$. We are interested in studying the bending of a beam under equilibrium, that is when all the forces on the beam sum to zero and thus the displacement is time-independent. In this elastostatic regime $\ddot{\bm{u}} = 0$ and thus we are left with a set of time-independent partial differential equations.

In order to solve for the displacement field $\bm{u}(x,y)$, we require more information to relate the components of the stress tensor $\sigma_{ij}(x,y)$ to the displacements $u_x(x,y)$ and $u_y(x,y)$. This information comes in the form of a set of strain-displacement relations and a constitutive relation. In their most general form, the strain-displacement relation can be expressed as
\begin{equation*}
  \bm{\varepsilon} =\frac{1}{2} \left[ \bm{\nabla u} + (\bm{\nabla u})^T \right]
\end{equation*}
while the constitutive relation is \emph{Hooke's Law}, $\bm{\sigma} = \bm{C : \varepsilon}$ where $\bm{\varepsilon}$ is the \emph{infinitesimal strain tensor} and $\bm{C}$ is the rank-4 \emph{stiffness tensor}. $\bm{M}^T$ represents the transpose of the matrix $\bm{M}$ and $\bm{A:B} = A_{ij}B_{ij}$ is the inner product for rank-2 tensors where summation over repeated indices is implied as per the \emph{Einstein summation convention}, or rather a small borrowing from the notation of Ricci calculus if you prefer.

In our case we are given the strain-displacement relations and the constitutive relation together, directly relating the stresses to the displacements by the matrix equation
\begin{equation}
\begin{pmatrix}
  \sigma_{xx} \\
  \sigma_{xy} \\
  \sigma_{yx} \\
  \sigma_{yy}
\end{pmatrix}
=
\frac{E}{1-\nu^2}
\begin{pmatrix}
  1 & 0 & 0 & \nu \\
  0 & \frac{1-\nu}{2} & \frac{1-\nu}{2} & 0 \\
  0 & \frac{1-\nu}{2} & \frac{1-\nu}{2} & 0 \\
  \nu & 0 & 0 & 1
\end{pmatrix}
\begin{pmatrix}
\p{u_x}{x} \\
\p{u_x}{y} \\
\p{u_y}{x} \\
\p{u_y}{y}
\end{pmatrix}
\end{equation}
where $E$ is the \emph{Young's modulus} and $\nu$ the \emph{Poisson ratio} of the material.

\begin{gather}
  \sigma_{xx} = \frac{E}{1-\nu^2} \left( \p{u_x}{x} + \nu\p{u_y}{y} \right) \nonumber \\
  \sigma_{yy} = \frac{E}{1-\nu^2} \left( \nu\p{u_x}{x} + \p{u_y}{y} \right) \\
  \sigma_{xy} = \sigma_{yx} = \frac{E}{1-\nu^2} \left( \frac{1-\nu}{2} \right) \left(\p{u_x}{y} + \p{u_y}{x} \right) \nonumber
\end{gather}

\section{Mathematical foundations}
Before we can develop a solution method or numerical scheme utilizing the finite element method, we will first express the partial differential equations in a \emph{weak formulation} admitting \emph{weak solutions} that may not be sufficiently differentiable to satisfy the strong formulation yet satisfy the weak formulation and represent physically realizable solutions. For the linear elasticity equation in particular, it so happens that the weak and strong formulations are actually equivalent.

\subsection{Derivation of the weak form of the linear elasticity equation}
Expanding the linear elasticity equation \eqref{eq:linElas} yields two partial differential equations
\begin{subequations}
\begin{gather}
  \p{\sigma_{xx}}{x} + \p{\sigma_{xy}}{y} + f_x = 0 \\
  \p{\sigma_{yx}}{x} + \p{\sigma_{yy}}{y} + f_y = 0
\end{gather}
\end{subequations}
which we can write more compactly as
\begin{equation} \label{eq:linElasij}
  \p{\sigma_{ij}}{x} + f_j = 0, \quad j=1,2
\end{equation}
where summation over the repeated index $i=1,2$ is implied as per the Einstein summation convention. The subscript 1 corresponds to the $x$ coordinate while $2$ corresponds to the $y$ coordinate.

We will now multiply \eqref{eq:linElasij} by a \emph{test function} $\bm{g} = (g_1,g_2)$ and integrate over the domain of the problem $\Omega$
\begin{equation}
  \iint_\Omega g_k(x,y) \left( \p{\sigma_{ij}}{x} + f_j \right) \, d\Omega = 0
\end{equation}
We note that $\bm{g} \in \mathcal{X}$ where $\mathcal{X}$ is a Sobolev space. In particular, $\mathcal{X} = H^1_\Omega$, the Hilbert space of once-differentiable functions.

\begin{equation}
\iint_\Omega g_k \p{\sigma_{ij}}{x} \, d\Omega + \iint_\Omega g_k f_j \, d\Omega = 0
\end{equation}

Noticing that the first term is a divergence of $\bm{\sigma}_j$ we can write
\begin{equation}
\iint_\Omega g_k \left( \bm{\nabla \cdot \sigma_j} \right) \, d\Omega + \iint_\Omega g_k f_j \, d\Omega = 0
\end{equation}
Now we make use of Green's theorem to rewrite the first term as
\begin{equation}
  \iint_\Omega g_k \left( \bm{\nabla \cdot \sigma_j} \right) \, d\Omega
  = \int_{\partial\Omega} g_k  \left( \bm{\sigma_j \cdot n} \right) \, d\ell
  - \iint_\Omega \nabla g_k \cdot \bm{\sigma_j} \, d\Omega
\end{equation}
so that we get
\begin{equation}
  \int_{\partial\Omega} g_k  \left( \bm{\sigma_j \cdot n} \right) \, d\ell
  - \iint_\Omega \nabla g_k \cdot \bm{\sigma_j} \, d\Omega
  + \iint_\Omega g_k f_j \, d\Omega = 0
\end{equation}

Adding the two equations together
\begin{equation}
    \int_{\partial\Omega} \left( \bm{\sigma}_x n_x + \bm{\sigma}_y n_y \right) \, d\ell
  - \iint_\Omega \left( \nabla g_x \cdot \bm{\sigma_x} + \nabla g_y \cdot \bm{\sigma_y} \right) \, d\Omega
  + \iint_\Omega \left( g_x f_x + g_y f_y \right) \, d\Omega = 0
\end{equation}
where the first term goes to zero because of the free boundary condition  $\bm{\sigma}_x n_x + \bm{\sigma}_y n_y = 0$. Expanding and rearranging we get
\begin{equation}
  \iint_\Omega \left( \p{g_x}{x}\sigma_{xx} + \p{g_x}{y}\sigma_{xy} + \p{g_y}{y}\sigma_{yx} + \p{g_y}{y}\sigma_{yy} \right) \, d\Omega = \iint_\Omega \left( g_x f_x + g_y f_y \right) \, d\Omega
\end{equation}
and plugging in we get
\begin{multline}
  \iint_\Omega \frac{E}{1-\nu^2} \left\{
    \p{g_x}{x} \left( \p{u_x}{x} + \nu\p{u_y}{y} \right)
    + \frac{1-\nu}{2} \left( \p{g_x}{y} + \p{g_y}{y} \right)
      \left( \p{u_x}{y} + \p{u_y}{x} \right) \right. \\ \left.
    + \p{g_y}{y} \left(\nu\p{u_x}{x} + \p{u_y}{y} \right)
  \right\} \, d\Omega
  - \iint_\Omega \left( g_x f_x + g_y f_y \right) \, d\Omega
  = 0
\end{multline}
and so we have our weak form
\begin{equation}
  a(\bm{u,g}) + \ell(\bm{g}) = 0 \quad \forall \bm{u,g} \in H^1_\Omega \times H^1_\Omega
\end{equation}
where
\begin{multline}
  a(\bm{u,g}) =
  \iint_\Omega \frac{E}{1-\nu^2} \left\{
    \p{g_x}{x} \left( \p{u_x}{x} + \nu\p{u_y}{y} \right)
    + \frac{1-\nu}{2} \left( \p{g_x}{y} + \p{g_y}{y} \right)
      \left( \p{u_x}{y} + \p{u_y}{x} \right) \right. \\ \left.
    + \p{g_y}{y} \left(\nu\p{u_x}{x} + \p{u_y}{y} \right)
  \right\} \, d\Omega
\end{multline}
and
\begin{equation}
  \ell(\bm{g}) = - \iint_\Omega \left( g_x f_x + g_y f_y \right) \, d\Omega
\end{equation}

\subsubsection*{Proof for the symmetric and positive-definiteness of the weak form}

\subsection{Discretization of the weak form}
We will discretize the weak form over the unit square $\Omega = [-1,1]\times[-1,1]$. We'll begin by expressing our variables of interest $\bm{u}$ and test functions $\bm{g}$ in terms of a set of bilinear basis functions
\begin{gather}
g_{--}(x,y) = \frac{(1+x)(1+y)}{4}, \quad g_{-+}(x,y) = \frac{(1+x)(1-y)}{4}\\
g_{+-}(x,y) = \frac{(1-x)(1+y)}{4}, \quad g_{++}(x,y) = \frac{(1-x)(1-y)}{4}
\end{gather}
As we are expressing both $\bm{u}$ and $\bm{g}$ in terms of the same basis functions, we are in effect employing a \emph{Galerkin method}, which is simplified when dealing with a symmetric and positive-definite bilinear weak form $a(\bm{u,g})$.

This allows us to express, for example, $u_x(x,y)$ as a linear combination of the basis functions
\begin{equation}
  u_x(x,y) = a_{ij}g_{ij}(x,y) \equiv \sumop_{i,j \in \{-,+\}} a_{ij}g_{ij}(x,y)
\end{equation}
where summation over repeated indices is now implied. Doing this for $\bm{u}$ and $\bm{g}$ we will write
\begin{equation}
\begin{gathered}
  u_x(x,y) = a_{ij}g_{ij}(x,y), \quad u_y(x,y) = b_{ij}g_{ij}(x,y) \\
  g_x(x,y) = c_{ij}g_{ij}(x,y), \quad g_y(x,y) = d_{ij}g_{ij}(x,y)
\end{gathered}
\end{equation}

Plugging these into the weak form, we get
\begin{multline}
  a(\bm{u},\bm{g}) = \frac{E}{1-\nu^2} \iint_\Omega \left\{
    c_{ij}\p{g_{ij}}{x} \left(
      a_{kl}\p{g_{kl}}{x}
      + \nu b_{kl}\p{g_{kl}}{y}
    \right) \right. \\ \left.
  + \frac{1-\nu}{2} \left(
    c_{ij}\p{g_{ij}}{y}
    + d_{ij}\p{g_{ij}}{x}
  \right)
  \left(
    a_{kl}\p{g_{kl}}{y}
     + b_{kl}\p{g_{kl}}{x}
   \right) \right. \\ \left.
  + d_{ij}\p{g_{ij}}{y} \left(
    \nu a_{kl}\p{g_{kl}}{x}
    + b_{kl}\p{g_{kl}}{y}
  \right)
\right\} \, d\Omega
\end{multline}
and
\begin{equation}
  \ell(\bm{g}) = -\iint_\Omega \left( c_{ij}g_{ij}f_x + d_{ij}g_{ij} f_y \right) \, d\Omega
\end{equation}

Expanding out the full weak form and factoring out the $c_{ij}$ and $d_{ij}$ coefficients we get
\begin{multline}
  \alpha \iint_\Omega \left\{
    c_{ij} \left[
      a_{kl}\G{i}{j}{k}{l}{x}{x} + \nu b_{kl}\G{i}{j}{k}{l}{x}{y}
      + \beta a_{kl}\G{i}{j}{k}{l}{y}{y} + \beta b_{kl}\G{i}{j}{k}{l}{y}{x}
      - \frac{1}{\alpha}g_{ij}f_x
    \right] \right. \\ \left.
    + d_{ij} \left[
      \beta a_{kl}\G{i}{j}{k}{l}{x}{y} + \beta b_{kl}\G{i}{j}{k}{l}{x}{x}
      + \nu a_{kl}\G{i}{j}{k}{l}{y}{x} + b_{kl}\G{i}{j}{k}{l}{y}{y}
      - \frac{1}{\alpha}g_{ij}f_y
    \right]
  \right\} \, d\Omega = 0
\end{multline}
where
\begin{equation}
  \alpha = \frac{E}{1-\nu^2}, \quad \beta = \frac{1-\nu}{2}
\end{equation}

Noticing that every term is integrated over $\Omega$ and contains a very similar pattern, we will introduce a new rank-6 tensor-like symbol
\begin{equation}
  G_{ijkl}^{mn} = \alpha \iint_\Omega \p{g_{ij}}{x_m} \p{g_{kl}}{x_n} d\Omega
\end{equation}
so that we can write
\begin{multline}
    c_{ij} \left[
      a_{kl} G_{ijkl}^{xx} + \nu b_{kl} G_{ijkl}^{xy}
      + \beta a_{kl} G_{ijkl}^{yy} + \beta b_{kl} G_{ijkl}^{yx}
      - \iint_\Omega \frac{1}{\alpha}g_{ij}f_x \, d\Omega
    \right] \\
  + d_{ij} \left[
    \beta a_{kl} G_{ijkl}^{xy} + \beta b_{kl} G_{ijkl}^{xx}
    + \nu a_{kl} G_{ijkl}^{yx} + b_{kl} G_{ijkl}^{yy}
    - \iint_\Omega \frac{1}{\alpha}g_{ij}f_y \, d\Omega
  \right] = 0
\end{multline}

However, $c_{ij}$ and $d_{ij}$ are the linear combination coefficients of the arbitrary test function $\bm{g}$. As this function must hold for all $\bm{g} \in H^1_\Omega$, it must also hold for all $c_{ij}$ and $d_{ij}$ and thus the terms inside the square brackets must vanish. This finally yields a set of 8 linear equations for the 8 coefficients $a_{ij}$ and $b_{ij}$ we desire to solve in order to find $u_x(x,y)$ and $u_y(x,y)$ in terms of the bilinear basis functions $g_{ij}(x,y)$
\begin{subequations}
\begin{gather}
  a_{kl} \left( G_{ijkl}^{xx} + \beta G_{ijkl}^{yy} \right)
    + b_{kl} \left( \nu G_{ijkl}^{xy} + \beta b_{kl} G_{ijkl}^{yx} \right)
    = \iint_\Omega \frac{1}{\alpha}g_{ij}f_x \, d\Omega \\
  a_{kl} \left( \beta G_{ijkl}^{xy} + \nu G_{ijkl}^{yx} \right)
    + b_{kl} \left( \beta G_{ijkl}^{xx} + G_{ijkl}^{yy} \right)
    = \iint_\Omega \frac{1}{\alpha}g_{ij}f_y \, d\Omega
\end{gather}
\end{subequations}
Recall that summation over $k,l \in \{-,+\}$ is implied and that we get an equation for each $i,j \in \{-,+\}$ which index the equations. For example, expanding the first equation for $i=-,j=-$ yields one of the eight linear equations for $a_{ij}$ and $b_{ij}$
\begin{equation}
\begin{aligned}
  & a_{--} \left( G_{----}^{xx} + \beta G_{----}^{yy} \right)
  + b_{--} \left( \nu G_{----}^{xy} + \beta G_{----}^{yx} \right) \\
  + \, & a_{-+} \left( G_{---+}^{xx} + \beta G_{---+}^{yy} \right)
  + b_{-+} \left( \nu G_{---+}^{xy} + \beta G_{---+}^{yx} \right) \\
  + \, & a_{+-} \left( G_{--+-}^{xx} + \beta G_{--+-}^{yy} \right)
  + b_{+-} \left( \nu G_{--+-}^{xy} + \beta G_{--+-}^{yx} \right)  \\
  + \, & a_{++} \left( G_{--++}^{xx} + \beta G_{--++}^{yy} \right)
  + b_{++} \left( \nu G_{--++}^{xy} + \beta G_{--++}^{yx} \right)
  = \frac{1}{\alpha} \iint_\Omega g_{--}f_x \, d\Omega
\end{aligned}
\end{equation}

We will now write this system of linear equations in the matrix form
\begin{equation}
\mathcal{M}\bm{a} = \bm{b}
\end{equation}
where
\begin{equation}
  \bm{a} =
    \begin{pmatrix}
      a_{--} \\
      b_{--} \\
      a_{-+} \\
      b_{-+} \\
      \cdots \\
      b_{++}
    \end{pmatrix}
  , \quad
  \bm{b} = \frac{1}{\alpha} \iint_\Omega
    \begin{pmatrix}
      g_{--}f_x \\
      g_{--}f_y \\
      g_{-+}f_x \\
      g_{-+}f_y \\
      \cdots \\
      g_{++}f_y
    \end{pmatrix}  
  \, d\Omega
\end{equation}
so that we may solve for the coefficients $\bm{a}$ like $\bm{a} = \mathcal{M}^{-1}\bm{b}$. With 8 equations for 8 unknowns and an inhomogenous right hand side, we have a full $8\times8$ matrix $\mathcal{M}$ but patterns can be found. The reason we ordered the coefficients in $\bm{a}$ as $a_{--}, b_{--}, a_{-+}, b_{-+}, \cdots, b_{++}$ was so that each $2\times2$ block in $\mathcal{M}$ takes on the form
\begin{equation}
  B_{\gamma\delta} =
  \begin{pmatrix}
    G_{\gamma\delta}^{xx} + \beta G_{\gamma\delta}^{yy}
      & \nu G_{\gamma\delta}^{xy} + \beta G_{\gamma\delta}^{yx} \\
    \beta G_{\gamma\delta}^{xy} + \nu G_{\gamma\delta}^{yx}
      & \beta G_{\gamma\delta}^{xx} + G_{\gamma\delta}^{yy}
    \end{pmatrix}
\end{equation}
where $\gamma,\delta \in \{(-,-), (-,+), (+,-), (+,+) \}$ index each $2\times2$ block. Thus, $\mathcal{M}$ can be expressed as
\begin{equation}
  \mathcal{M} =
  \begin{pmatrix}
    B_{--,--} & B_{--,-+} & B_{--,+-} & B_{--,++} \\
    B_{-+,--} & B_{-+,-+} & B_{-+,+-} & B_{-+,++} \\
    B_{+-,--} & B_{+-,-+} & B_{+-,+-} & B_{+-,++} \\
    B_{++,--} & B_{++,-+} & B_{++,+-} & B_{++,++}
  \end{pmatrix}
\end{equation}

\subsection{Evaluating $\mathcal{M}$ by two-dimensional Gauss-Legendre quadrature}

\subsection{Mapping the problem to a general square domain }

\subsection{Dependence of the weak form on Dirchlet boundary conditions}

\subsection{Imposing Dirchlet boundary conditions on the left boundary}

\section{Solving the linear elasticity equation for a beam under stress}

To exert at a specific point $(x,y) = (1,0)$ we will express the force vector $\bm{f}$ using a Dirac delta function such that
\begin{equation}
  f_x(x,y) = 0, \quad f_y(x,y) = -F_\delta \delta(x-1)\delta(y)
\end{equation}
where $F_\delta = \SI{8e4}{\N}$ is the magnitude of the force. Then using the following property of the Dirac-delta function
\begin{equation}
  \int_{-\infty}^{\infty} f(x) \delta(x-a) \, dx = f(a)
\end{equation}
we can write the components of the right hand side vector $\bm{b}$ as
\begin{equation}
  \frac{1}{\alpha} \iint_\Omega g_{ij} f_x \, d\Omega = 0, \quad 
  \frac{1}{\alpha} \iint_\Omega g_{ij} f_y \, d\Omega = -F_\delta g_{ij}(1,0)
\end{equation}


\end{document}